1. 학습 날짜 // 2020-12-08(화)
2. 학습시간 // 9:00~22:00

3. 학습 범위 및 주제 // SQL
4. 동료 학습 방법 // -
5. 학습 목표 // SQL 첫걸음 독파

---

6. 상세 학습 내용

이노콘으로 인해 미팅을 연기했다. 덕분에 SQL 개념 공부를 좀 더 여유있게 할 수 있었다.

하단은 'SQL 첫걸음' 책을 읽으며 18장까지 간단하게 메모한 것이다.

# SQL 첫걸음

SQL 개념을 간단하게 훑으며 메모할만한 부분을 적습니다.



젤 참고할만한건 역시 내부처리 순서

> 내부처리 순서
>
> FROM, JOIN구-> WHERE 구 -> GROUP BY 구 -> HAVING 구 -> SELECT 구 -> DISTINCT구 -> ORDER BY 구 -> LIMIT / OFFSET 구

자주 쓸만한 패턴

`SELECT name, COUNT(name), SUM(quantity) FROM sample1 GROUP BY name ORDER BY SUM(quantity) DESC;`



## 4강 Hello world 실행하기

`SELECT * FROM sample21;` 

: sample21 테이블 내의 모든 열을 불러온다.



메모

- 예약어와 데이터베이스 객체명은 대소문자를 구별하지 않는다.
- 데이터는 자료형으로 분류할 수 있다.
- 열은 하나의 자료형만 가질 수 있다.
- NULL은 데이터가 들어있지 않은 것을 의미하는 특별한 값이다.



## 5강 테이블 구조 참조하기

`DESC sample21;`

: sample21 테이블 내에 어떤 열이 정의되어 있는지 확인한다.



#### 메모

- 문자열 형에서는 열의 최대 길이를 지정해야한다. 가령 CHAR(10)으로 자료형을 지정했다면 최대 10문자로 된 문자열을 저장할 수 있다. 가변길이로 문자열을 저장하려면 VARCHAR 자료형을 쓰자.



## 6강 검색 조건 지정하기

1. SELECT 구에서 열 지정하기
   - `SELECT 열1, 열2 FROM 테이블명;`
2. WHERE 구에서 행 지정하기
   - `SELECT 열 FROM 테이블명 WHERE 조건식;` 
   - 조건식에 일치하는 행이 없으면 아무것도 반환되지 않는다.



#### 메모

- SQL에서는 구의 순서가 정해져있다. 가령 WHERE문 뒤에 FROM문을 적으면 에러가 난다.
- 조건식은 참 또는 거짓의 진리값을 반환하는 식으로 비교 연산자를 사용해 표현한다.
- 조건식에 문자열 리터럴을 넣을 때는 홀따옴표로 둘러싸야한다.
- 조건식에 날짜시간형일 때도 홀따옴표로 둘러싼다. 이 때 연원일은 하이픈(-)으로, 시각은 시분초를 콜론(:)으로 표기한다.

- NULL 값은 '=' 연산자로 검색할 수 없다. 대신 **IS NULL**을 사용한다. NULL이 아닌 값을 검색하고 싶다면 **IS NOT NULL**을 사용하자.
  ex) `SELECT * FROM sample21 WHERE day IS NULL;`



## 7장 조건 조합하기

솔직히 상식적으로 조건문에 AND, OR를 쓰면된다.

하지만 아래 경우는 주의하자.

1. 숫자만 쓰면 참이다. 아래처럼 쓰면 '2'는 항상 참이므로 모든 행을 불러온다. `no =1 OR no = 2`라고 써야 의도한 결과가 나올 것이다.
   `SELECT * FROM sample24 WHERE no = 1 OR 2;` 
2. 연산자 우선순위를 주의하자. **AND가 OR보다 높다.**

3. NOT 연산자는 오른쪽에만 항목을 지정하는 '단항 연산자'이다. 아래처럼 쓴다.
   `SELECT * FROM sample24 WHERE NOT(a<>0 OR b<>0);`

## 8장 패턴 매칭에 의한 검색

#### LIKE로 패턴 매칭하기

= 연산자는 열 값이 완전히 일치할 때 참이 된다. 반면 LIKE 술어는 열 값이 부분적으로 일치하는 경우에도 참이 된다. 

검색에 쓰이는 와일드카드 aka 메타문자는 아래와 간다. 메타문자를 패턴 검색하려면 이스케이프 문자`\`를 쓰자.

- `%`: 임의의 문자열과 매칭된다. 빈 문자열과도 매칭된다.
- `_`: 임의의 문자 하나와 매칭된다.
- 문자열 상수 `'`의 이스케이프는 `''` 으로 쓴다.

더 복잡한거 검색하려면 정규표현식을 활용하자.

## 9장 정렬 - ORDER BY

오름차순 정렬: `SELECT * FROM sample31 ORDER BY address;`  or`SELECT * FROM sample31 ORDER BY address ASC;`

내림차순 정렬: `SELECT * FROM sample31 ORDER BY address DESC; ` 



#### 메모

- 문자열형 데이터의 대소관계는 사전식 순서에 의해 결정된다.
- ORDER BY는 테이블에 영향을 주지 안흔ㄴ다. 단지 행 순서를 바꾸어 결과를 반환하는 것 뿐.

- 만약 ORDER BY를 생략하면 순서는 어떻게 될까? 답은 '일정하지 않다'이다. 데이터베이스 서버의 당시 상황에 따라 어떤 순서로 행을 반환할지 결정된다.

## 10장 복수의 열을 지정해 정렬하기

`SELECT 열명 FROM 테이블명 WHERE 조건식 ORDER BY 열명1, 열명2`



#### 메모

- NULL 값에 관해서는 대소비교 방법이 표준 SQL에 규정되어있지 않다. 따라서 데이터베이스 제품마다 다른데 보통 NULL 값을 가지는 행이 가장 먼저 표시되거나 가장 나중에 표시된다.

## 11장 결과 행 제한하기 - LIMIT

`SELECT 열명 FROM 테이블명 LIMIT 행수 [OFFSET 시작행]`

WHERE 구로 검색한 후, ORDER BY로 정렬된 뒤 최종적으로 처리된다.

#### 메모

- LIMIT 구는 표준 SQL이 아니다. 제품마다 비슷한 기능을 다르게 표현할 것이다.
  - OFFSET은 0에서부터 시작한다.

## 12장 수치 연산

SQL은 데이터베이스를 조작하는 언어지만 컴퓨터를 조작하는 언어이기도 한 만큼 기본적으로 계산기능을 포함한다.

연산자는 아래와 같다.

- `+-*/%` 제품에 따라 % 대신 MOD를 쓰는 경우도 있다.



SELECT 구, WHERE 구, ORDER BY 구에서도 연산이 가능하다.

ex) `SELECT *, price * quantity As amount FROM sample1;` 

: 모든 열을 표시하고, price 열과 quantity 열을 곱한 결과를 amount라는 이름의 열로 표시한다.



#### 함수

함수도 연산자와 표기 방법이 다를 뿐 같은 것이다. 

ex) `SELECT amount, ROUND(amount, 1) FROM sample1;` 하면 amount 데이터를 1의 소수 둘째자리에서 반올림한 값을 열로 표시할 수 있다.



#### 메모

- 열 이름으로 ASCII 이외의 것을 포함할 경우에는 더블쿼트로 둘러사서 지정한다.
- 이름은 숫자로 시작할 수 없다. 제품에 따라 더블쿼트로 둘러싸면 쓸 수 있긴한데 왠만하면 그러지 말자.
- 표준 SQL에는 내부처리 순서가 따로 정해져있지 않으나 **보통 WHERE 구에서의 행 선택, SELECT 구에서의 열 선택은 데이터베이스 서버 내부에서 전자 -> 후자의 순서로 처리된다.** 따라서 SELECT 구에서 지정한 별명은 WHERE 구 안에서 사용할 수 없는 것이 보통이다.
  ex) `SELECT *, price * quantity AS amount FROM sample1 WHERE amount >= 2000;` 처럼 쓰면 에러가 발생한다. 내부적으로 amount라는 별칭이 지정되기 전에 WHERE 문이 실행되기 때문!
- NULL 로 연산하면 결과는 NULL이 된다.
- **한편 ORDER_BY는 서버에서 내부적으로 가장 나중에 처리된다.** 따라서 SELECT 구에서 지정한 별명을 ORDER_BY에서 사용할 수 있다.



## 13장 문자열 연산

1. 문자열 결합
   데이터베이스 제품에 따라 `+` 연산자나 `||` 연산자, `CONCAT` 함수로 문자열을 결합할 수 있다.

2. SUBSTRING 함수

3. TRIM 함수
   문자열 앞뒤로 여분의 스페이스가 있을 경우 이를 제거해줌. 인수를 지정해서 스페이스 외 다른 문자를 제거할 수 도 있다.

4. CHARACTER_LENGTH 함수

   문자열 길이를 계산하여 반환하는 함수. VARCHAR 형의 문자열 처럼 가변길이일 경우 유용하다.

   한편 OCTET_LENGTH 함수는 문자열의 길이를 바이트 단위로 계산해 돌려준다. 같은 문자 수라도 문자열 데이터의 바이트 수는 달라질 수 있다. 왜냐하면 문자 하나의 데이터가 몇 바이트의 저장공간을 필요로 하는지는 '인코드 방식' 에 따라 결정되기 때문이다.

   

## 14장 날짜 연산

표준 SQL에서는 CURRENT_TIMESTAMP 함수를 실행한 시점을 기준으로 시간을 표시한다.

데이터베이스별로 이 날짜를 서식을 지정해서 출력시킬 수 있다.

날짜 연산 예시는 아래와 같다. 데이터베이스 메뉴얼을 참고하자.

`SELECT CURRENT_DATE + INTERVAL 1 DAY;` 



## 15장 CASE 문으로 데이터 변환하기

```
CASE WHEN 조건식1 THEN 식1
[WHEN 조건식2 THEN 식2 ...]
[ELSE 식3]
END
```

예시) `SELECT a, CASE WHEN a IS NULL THEN 0 ELSE a END "a(null=0)" FROM sample1;`



#### 메모

- NULL 값을 변환하는 경우라면 COALESCE 함수를 사용하면 쉽다.

- ELSE 를 생략하면 ELSE NULL이 된다.



## 16장 행 추가하기 - INSERT

`INSERT INTO 테이블명 VALUES (값 1, 값 2, ...)`

아래처럼 열을 지정해줄 수도 있다. 값을 따로 안 적어준 열은 DEFAULT 값이 들어갈 것이다.

`INSERT INTO 테이블명(열1, 열2, ...) VALUES (값1, 값2, ...)`



## 17장 삭제하기 - DELETE

`DELETE FROM 테이블명 WHERE 조건식`

조건식에 맞으면 다 삭제해버린다.



## 18장 데이터 갱신하기 - UPDATE

`UPDATE 테이블명 SET 열명1 = 값1, 열명2 = 값2, ... WHERE 조건식`



#### 메모

- 테이블에 존재하지 않는 열을 지정하면 에러가 발생하며 UPDATE 명령은 실행되지 않는다.
- 데이터베이스 제품에 따라 처리 순서가 다를 수 있다.




---

7. 학습 내용에 대한 개인적인 총평

이노콘, 생각보다 콘텐츠 질이 높아서 놀랐습니다. 재단 분들 정말 고생많으셨겠다는 생각 반, 내가 진짜 즐겁게 학습하고 있구나 싶은 생각이 반 들었습니다. 사실 주제와 질문의 한계로 연사 분들의 말씀 자체는 그리 새로운 내용은 없었던 것 같지만, 다시금 마음을 다잡는 계기로 삼았습니다ㅎㅎ 

아! 글쓰기의 중요성을 다시 들으니 의식적으로 노력해야겠다는 생각이 들었네요. 블로그를 다시 써봐야겠습니다.

오늘도 후회없이 살아야지!

---

다음 학습 계획

- SQL 책 독파

